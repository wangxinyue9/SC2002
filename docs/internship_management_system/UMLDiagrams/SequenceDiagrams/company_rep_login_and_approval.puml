@startuml
title Company Representative - Login & Staff Approval Flow

actor ":Company Representative" as CR
control "ui:UIManager" as UIManager
boundary "login:LoginScreen" as LoginScreen
entity "state:UIState" as UIState
database "ds:DataStorage" as DataStorage
boundary "home:CompanyRepHome" as CompanyRepHome
actor ":Career Centre Staff" as CCS
boundary "ccsOpp:CCSOpportunityScreen" as CCSOpp
entity "opp:InternshipOpportunity" as Opportunity

== Login ==
CR -> UIManager: startSession()
activate UIManager
UIManager -> LoginScreen: show(uiState)
activate LoginScreen
CR -> LoginScreen: enter username/password
LoginScreen -> DataStorage: getUserByUserID(userId)
activate DataStorage
DataStorage --> LoginScreen: Optional<User>
deactivate DataStorage
LoginScreen -> CR: show invalid credentials?
alt invalid credentials
    LoginScreen --> UIManager: LoginScreen.INSTANCE (retry)
    deactivate LoginScreen
    deactivate UIManager
    return
else valid credentials
    LoginScreen -> UIState: setCurrentUser(CR account)
    LoginScreen --> UIManager: CompanyRepHome.INSTANCE
end
deactivate LoginScreen

== Home Screen Approval Gate ==
UIManager -> CompanyRepHome: show(uiState)
activate CompanyRepHome
alt CR pending or rejected
    CompanyRepHome -> CR: display status message
    CompanyRepHome -> UIState: setCurrentUser(Optional.empty)
    CompanyRepHome --> UIManager: HomeScreen.INSTANCE
    deactivate CompanyRepHome
    deactivate UIManager
    return
else CR approved
    CompanyRepHome -> CR: show management menu
    CompanyRepHome --> UIManager: InternshipOpportunityList.INSTANCE
end
deactivate CompanyRepHome

== Career Centre Staff Approval ==
CR -> CCS: submit opportunity for approval (out-of-band)
CCS -> UIManager: open CCS workflow
UIManager -> CCSOpp: show(uiState)
activate CCSOpp
CCSOpp -> Opportunity: inspect status
alt status == PENDING
    CCSOpp -> CCS: offer Approve / Reject
    alt approve
        CCSOpp -> Opportunity: setStatus(APPROVED)
        note right of CCSOpp
        Students can only see/apply when status becomes APPROVED.
        end note
    else reject
        CCSOpp -> Opportunity: setStatus(REJECTED)
        CCSOpp -> CR: communicate decision (via system notice/email)
    end
else already resolved
    CCSOpp -> CCS: show read-only details
end
CCSOpp --> UIManager: return to CCS menu
deactivate CCSOpp

UIManager --> LoginScreen: loop back / exit
deactivate UIManager
@enduml
